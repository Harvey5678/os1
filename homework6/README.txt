NOTE: Sorry that I cannot meet all requirements before sunday. I'm pretty much done, but I cannot figure out how to create arbitrary number of threads running concurrently. I need one more day to submit the full version. 